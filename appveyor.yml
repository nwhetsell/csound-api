# https://www.appveyor.com/docs/appveyor-yml

environment:
  matrix:
    - nodejs_version: Current
    - nodejs_version: '12'
    - nodejs_version: '10'
    - nodejs_version: LTS

install:
  # Remove large directories to stay below AppVeyorâ€™s disk usage quota.
  - rd C:\cygwin /s /q
  - rd C:\Qt /s /q
  # Install Node.js.
  - ps: Install-Product node $Env:nodejs_version x64
  # Install Csound; see https://www.appveyor.com/docs/how-to/download-file.
  - ps: Start-FileDownload 'https://github.com/csound/csound/releases/download/6.13.0/Csound6.13.0_Windows_x64-installer.exe'
  - ps: Start-Process Csound6.13.0_Windows_x64-installer.exe '/verySilent /noRestart' -Wait
  - set PATH=%PATH%;%ProgramFiles%\Csound6_x64\bin
  - npm install --global node-gyp
  - npm install nan

build_script:
  - set CL=/I"C:\Libraries\boost_1_69_0" /I"%ProgramFiles%\Csound6_x64\include"
  - set LINK="%ProgramFiles%\Csound6_x64\lib\csound64.lib"
  - node-gyp rebuild

test_script:
  - npm install --global jasmine
  - npm install bindings jasmine-terminal-reporter
  - jasmine
